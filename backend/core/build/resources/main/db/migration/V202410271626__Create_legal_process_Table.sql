-- Create table legal_process

DO $$
BEGIN
    IF EXISTS (SELECT FROM pg_tables WHERE schemaname = 'public' AND tablename = 'legal_process') THEN
        RAISE NOTICE 'The legal_process table already exists !';
    ELSE
        CREATE TABLE legal_process (
            id bigint PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
            process_code varchar(255) NOT NULL CONSTRAINT process_code_UK UNIQUE,
            acordao_code bigint NOT NULL,
            class varchar(255) NOT NULL,
            subject varchar(255) NOT NULL,
            rapporteur varchar(255) NOT NULL,
            district varchar(255) NOT NULL,
            judging_body varchar(255),
            judgment_date date,
            publish_date date,
            headnote text,
            legal_process_file_id bigint,

            CONSTRAINT legal_process_file_FK FOREIGN KEY (legal_process_file_id) REFERENCES legal_process_file (id)
        ) INHERITS (audit_data);

        RAISE NOTICE 'legal_process table created successfully.';
    END IF;
END $$;
